(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["computes"],{"0c6d":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return l}));var o=a("bc3a"),r=a.n(o);function n(e){var t=r.a.create({baseURL:window.url.ssourl,timeout:5e3});return t(e)}function s(e){var t=r.a.create({baseURL:window.url.coreurl,timeout:5e3});return t(e)}function l(e){var t=r.a.create({baseURL:window.url.vneturl,timeout:5e3});return t(e)}},"13ea":function(e,t,a){"use strict";a("bec6")},"1da1":function(e,t,a){"use strict";function o(e,t,a,o,r,n,s){try{var l=e[n](s),i=l.value}catch(d){return void a(d)}l.done?t(i):Promise.resolve(i).then(o,r)}function r(e){return function(){var t=this,a=arguments;return new Promise((function(r,n){var s=e.apply(t,a);function l(e){o(s,r,n,l,i,"next",e)}function i(e){o(s,r,n,l,i,"throw",e)}l(void 0)}))}}a.d(t,"a",(function(){return r}))},"2e5a":function(e,t,a){},"493c":function(e,t,a){},"8abb":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticStyle:{"margin-bottom":"20px"}},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/zones"}}},[e._v("资源池")]),a("el-breadcrumb-item",[e._v(e._s(e.$route.query.zone))])],1)],1),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.AddNodeForm=!0}}},[e._v("增加宿主节点")]),a("el-dialog",{attrs:{title:"增加宿主节点",visible:e.AddNodeForm,width:"30%","close-on-click-modal":!1,center:""},on:{close:e.CreateVmDialogClose,"update:visible":function(t){e.AddNodeForm=t}}},[a("el-form",{ref:"AddNodeRef",attrs:{model:e.add_node,rules:e.AddNodeRules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"节点地址",prop:"addr"}},[a("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"请选择节点地址"},on:{focus:e.getagentnode},model:{value:e.add_node.addr,callback:function(t){e.$set(e.add_node,"addr",t)},expression:"add_node.addr"}},e._l(e.AgentData,(function(e){return a("el-option",{key:e.key,attrs:{label:e.agent,value:e.agent}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.CreateNode}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.AddNodeForm=!1}}},[e._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:"宿主节点云主机",visible:e.NodeVmForm,width:"60%",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.NodeVmForm=t}}},[a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.NodeVmData,"header-cell-class-name":"table-header"}},[e.show?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}):e._e(),a("el-table-column",{attrs:{prop:"vmname",label:"主机名称",align:"center"}}),a("el-table-column",{attrs:{prop:"desc",label:"主机描述",align:"center"}}),a("el-table-column",{attrs:{prop:"ip",label:"主机地址",align:"center"}}),a("el-table-column",{attrs:{prop:"vcpu",label:"CPU数量",align:"center"}}),a("el-table-column",{attrs:{prop:"vmem",label:"内存(MB)",align:"center"}}),a("el-table-column",{staticStyle:{"font-size":"16px"},attrs:{prop:"state",label:"运行状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return["up"===e.row.state?a("span",{staticStyle:{color:"#37B328","font-size":"20px"}},[a("i",{staticClass:"el-icon-caret-right"})]):a("span",{staticStyle:{color:"red","font-size":"20px"}},[a("b-icon",{attrs:{icon:"stop-fill"}})],1)]}}])})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.NodeVmForm=!1}}},[e._v("确 定")])],1)],1)],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.NodesData,"header-cell-class-name":"table-header"}},[e.show?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}):e._e(),a("el-table-column",{attrs:{prop:"node",label:"宿主节点名称",align:"center"}}),a("el-table-column",{attrs:{prop:"addr",label:"宿主节点地址",align:"center"}}),a("el-table-column",{attrs:{prop:"state",label:"运行状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["up"===t.row.status?a("span",{staticStyle:{color:"#37B328"}},[e._v("在线")]):a("span",{staticStyle:{color:"red"}},[e._v("离线")])]}}])}),a("el-table-column",{attrs:{prop:"state",label:"使用状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return["open"===e.row.state?a("span",{staticStyle:{color:"#37B328"}},[a("b-icon",{attrs:{icon:"unlock"}})],1):a("span",{staticStyle:{color:"red"}},[a("i",{staticClass:"el-icon-lock"})])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return["open"===t.row.state?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"锁定节点",placement:"top-start"}},[a("el-button",{staticStyle:{color:"red"},attrs:{icon:"el-icon-lock",circle:""},on:{click:function(a){return e.Disable(t.row)}}})],1):a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"解锁节点",placement:"top-start"}},[a("el-button",{staticStyle:{color:"#37B328"},attrs:{circle:""},on:{click:function(a){return e.Enable(t.row)}}},[a("b-icon",{attrs:{icon:"unlock"}})],1)],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"宿主节点详情",placement:"top-start"}},[a("el-button",{attrs:{type:"orange",icon:"el-icon-menu",circle:""},on:{click:function(a){return e.NodeDetail(t.row.id,t.row.addr)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"云主机列表",placement:"top-start"}},[a("el-button",{attrs:{type:"orange",icon:"el-icon-cloudy",circle:""},on:{click:function(a){return e.VmDetail(t.row.id)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除宿主节点",placement:"top-start"}},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.NodeDel(t.row)}}})],1)]}}])})],1),a("div",{staticClass:"block",staticStyle:{height:"70px"}},[a("el-pagination",{attrs:{"page-sizes":[10,20],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next",total:e.page.totalRecords},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)],1)},r=[],n=(a("96cf"),a("1da1")),s=a("0c6d"),l=sessionStorage.getItem("user_info"),i=JSON.parse(l),d={data:function(){return{show:!1,Node_id:"",NodeVmData:[],AgentData:[],NodesData:[],AddNodeForm:!1,NodeVmForm:!1,add_node:{addr:"",zone:this.$route.query.zone},AddNodeRules:{addr:[{required:!0,message:"请输入节点IP地址",trigger:"blur"}]},page:{pageSize:10,totalRecords:0,totalPages:0,pageNum:0,pagelimit:0}}},mounted:function(){this.getNodes()},methods:{CreateVmDialogClose:function(){void 0!==this.$refs.AddNodeRef&&this.$refs.AddNodeRef.resetFields()},getagentnode:function(){var e=this;this.AgentData=[],Object(s["a"])({url:"/listagentnodes",method:"get",headers:{authorization:i.token_type+" "+i.access_token}}).then((function(t){e.AgentData=t.data}))},getNodes:function(){var e=this;this.NodesData=[];var t=this.page,a=t.pageNum,o=t.pageSize,r=t.pagelimit;r=a*o;var n="/nodes/"+this.$route.query.zone+"?skip="+r+"&limit="+o;Object(s["a"])({url:n,method:"get",headers:{authorization:i.token_type+" "+i.access_token}}).then((function(t){e.page.totalRecords=t.data.count,e.NodesData=t.data.data})),this.$forceUpdate()},sizeChange:function(e){this.page.pageSize=e,this.getNodes()},currentChange:function(e){this.page.pageNum=e-1,this.getNodes()},CreateNode:function(){var e=this;this.$refs.AddNodeRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=3;break}return e.$message.error("请输入宿主节点IP地址"),t.abrupt("return",!1);case 3:Object(s["a"])({url:"/node",method:"post",data:e.add_node,headers:{authorization:i.token_type+" "+i.access_token}}).then((function(t){200===t.data.code?(e.$message.success("增加宿主节点"+t.data.data[0].addr+"成功"),e.AddNodeForm=!1,e.$refs.AddNodeRef.resetFields(),e.getNodes()):e.$message.error("增加宿主节点失败,宿主节点已存在或者其它错误")}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},Disable:function(e){var t=this;if("open"===e.state){var a={id:e.id,state:"lock"};this.$confirm("确认禁用宿主节点"+e.addr+", 是否继续?","提示",{type:"warning"}).then((function(){Object(s["a"])({url:"/setnodestate",method:"post",data:a,headers:{authorization:i.token_type+" "+i.access_token}}).then((function(a){200===a.data.code?(t.$message.success("宿主节点"+a.data.data[0].addr+"禁用成功"),t.getNodes()):t.$message.error("禁用宿主节点"+e.addr+"失败,原因  "+a.data.message)}))})).catch((function(){}))}},Enable:function(e){var t=this;if("lock"===e.state){var a={id:e.id,state:"open"};this.$confirm("确认启用宿主节点"+e.addr+", 是否继续?","提示",{type:"warning"}).then((function(){Object(s["a"])({url:"/setnodestate",method:"post",data:a,headers:{authorization:i.token_type+" "+i.access_token}}).then((function(a){200===a.data.code?(t.$message.success("宿主节点"+a.data.data[0].addr+"启用成功"),t.getNodes()):t.$message.error("启用宿主节点"+e.addr+"失败,原因  "+a.data.message)}))})).catch((function(){}))}},VmDetail:function(e){this.NodeVmForm=!0,this.ListNodeVm(e)},ListNodeVm:function(e){var t=this;this.NodeVmData=[];var a="/listnodevm/"+e;Object(s["a"])({url:a,method:"get",headers:{authorization:i.token_type+" "+i.access_token}}).then((function(e){t.NodeVmData=e.data.data})),this.$forceUpdate()},NodeDetail:function(e,t){this.$router.push({path:"/nodeperfs",query:{node:t,id:e,zone:this.$route.query.zone}})},NodeDel:function(e){var t=this;this.$confirm("此操作将永久删除宿主节点"+e.addr+", 是否继续?","提示",{type:"warning"}).then((function(){Object(s["a"])({url:"/deletenode/"+e.id,method:"post",headers:{authorization:i.token_type+" "+i.access_token}}).then((function(e){200===e.data.code?(t.$message.success("删除节点"+e.data.data[0].addr+"成功"),t.getNodes()):t.$message.error("删除节点失败,错误 "+e.data.message)}))})).catch((function(){}))}}},c=d,u=(a("13ea"),a("2877")),m=Object(u["a"])(c,o,r,!1,null,"17da165e",null);t["default"]=m.exports},"9b2c":function(e,t,a){"use strict";a("493c")},bec6:function(e,t,a){},c79d:function(e,t,a){"use strict";a("2e5a")},f46b:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/zones"}}},[e._v("资源池")]),a("el-breadcrumb-item",[e._v(e._s(e.$route.query.device.zone))]),a("el-breadcrumb-item",[e._v(e._s(e.$route.query.device.addr))])],1)],1),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("div",{staticClass:"handle-box"},[a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"Command name description"},model:{value:e.cmdname,callback:function(t){e.cmdname=t},expression:"cmdname"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"}}),a("el-button",{staticClass:"mr10",attrs:{type:"primary",icon:"el-icon-plus "},on:{click:function(t){e.AddNetDevCmdForm=!0}}})],1),a("el-dialog",{attrs:{title:"增加网络设备配置命令",visible:e.AddNetDevCmdForm,width:"40%","close-on-click-modal":!1,center:""},on:{close:e.AddNetDevCmdDialogClose,"update:visible":function(t){e.AddNetDevCmdForm=t}}},[a("el-form",{ref:"AddNetDevCmdRef",attrs:{model:e.netdevcmd,rules:e.AddNetDevCmdRules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"命令类型",prop:"cmdmode"}},[a("el-select",{staticStyle:{width:"350px"},attrs:{placeholder:"请选择命令类型"},model:{value:e.netdevcmd.cmdmode,callback:function(t){e.$set(e.netdevcmd,"cmdmode",t)},expression:"netdevcmd.cmdmode"}},[a("el-option",{key:"nvlan",attrs:{label:"增加vlan",value:"nvlan"}}),a("el-option",{key:"dvlan",attrs:{label:"删除vlan",value:"dvlan"}})],1)],1),a("el-form-item",{attrs:{label:"配置命令",prop:"cmd"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{type:"textarea",placeholder:"命令组 每一行代表一条命令",rows:10,"auto-complete":"off"},model:{value:e.netdevcmd.cmd,callback:function(t){e.$set(e.netdevcmd,"cmd",t)},expression:"netdevcmd.cmd"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.CreateNetDevCmd}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.AddNetDevCmdForm=!1}}},[e._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:"修改网络设备的配置命令",visible:e.SetDevCmdForm,width:"40%","close-on-click-modal":!1,center:""},on:{close:e.SetDevCmdDialogClose,"update:visible":function(t){e.SetDevCmdForm=t}}},[a("el-form",{ref:"DevCmdSetRef",attrs:{model:e.devcmdset,rules:e.DevCmdSetRules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"配置命令",prop:"cmd"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{type:"textarea",placeholder:"命令组 每一行代表一条命令",rows:10,"auto-complete":"off"},model:{value:e.devcmdset.cmd,callback:function(t){e.$set(e.devcmdset,"cmd",t)},expression:"devcmdset.cmd"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.NetDevCmdSet}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.SetDevCmdForm=!1}}},[e._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:"命令内容",visible:e.DetaildevCmdForm,width:"50%",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.DetaildevCmdForm=t}}},[a("div",{attrs:{"text-align:center":""}},[a("b-table-simple",{attrs:{hover:"",small:"","caption-top":"",responsive:""}},[a("b-tbody",[a("b-tr",[a("b-td",{attrs:{colspan:"2"}},[e._v("网络设备地址")]),a("b-td",[e._v(e._s(e.DevCmdData.addr))])],1),a("b-tr",[a("b-td",{attrs:{colspan:"2"}},[e._v("配置命令文件")]),a("b-td",[e._v(e._s(e.DevCmdData.cmdfile))])],1),a("b-tr",[a("b-td",{attrs:{colspan:"2"}},[e._v("配置命令内容")]),a("b-td",[e._v(e._s(e.DevCmdData.cmd))])],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.DetaildevCmdForm=!1}}},[e._v("确 定")])],1)])],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.NetDevCmdDatas,"header-cell-class-name":"table-header"}},[e.show?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}):e._e(),a("el-table-column",{attrs:{prop:"addr",label:"设备地址",align:"center",width:"150px"}}),a("el-table-column",{attrs:{prop:"cmdmode",label:"命令类型",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return["nvlan"===t.row.cmdmode?a("span",{staticStyle:{color:"#0000CD"}},[e._v("增加vlan")]):"dvlan"===t.row.cmdmode?a("span",{staticStyle:{color:"#DC143C"}},[e._v("删除vlan")]):a("span",{staticStyle:{color:"red"}},[e._v("错误命令")])]}}])}),a("el-table-column",{attrs:{prop:"cmdfile",label:"命令内容存储文件",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"250px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"配置命令内容",placement:"top-start"}},[a("el-button",{attrs:{type:"orange",circle:""},on:{click:function(a){return e.DevCmdDetail(t.row.id)}}},[a("b-icon",{attrs:{icon:"journal-text"}})],1)],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改配置命令",placement:"top-start"}},[a("el-button",{attrs:{type:"orange",circle:""},on:{click:function(a){return e.SetNetDevCmd(t.row.id)}}},[a("b-icon",{attrs:{icon:"hammer"}})],1)],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除命令",placement:"top-start"}},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.NetDevCmdDel(t.row)}}})],1)]}}])})],1),a("div",{staticClass:"block",staticStyle:{height:"70px"}},[a("el-pagination",{attrs:{"page-sizes":[10,20],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next",total:e.page.totalRecords},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)],1)},r=[],n=(a("96cf"),a("1da1")),s=a("0c6d"),l=sessionStorage.getItem("user_info"),i=JSON.parse(l),d={data:function(){return{show:!1,cmdname:"",NetDevCmdDatas:[],DevCmdData:[],AddNetDevCmdForm:!1,SetDevCmdForm:!1,DetaildevCmdForm:!1,netdevcmd:{addr:this.$route.query.device.addr,cmd:"",cmdmode:""},devcmdset:{id:"",cmd:""},AddNetDevCmdRules:{cmd:[{required:!0,message:"请输入网络设备配置的命令组",trigger:"blur"}],cmdmode:[{required:!0,message:"请选择命令类型",trigger:"blur"}]},DevCmdSetRules:{cmd:[{required:!0,message:"请输入网络设备配置的命令组",trigger:"blur"}]},page:{pageSize:10,totalRecords:0,totalPages:0,pageNum:0,pagelimit:0}}},mounted:function(){this.FetchNetDevCmds(this.$route.query.device.addr)},methods:{AddNetDevCmdDialogClose:function(){void 0!==this.$refs.AddNetDevCmdRef&&this.$refs.AddNetDevCmdRef.resetFields()},SetDevCmdDialogClose:function(){void 0!==this.$refs.DevCmdSetRef&&this.$refs.DevCmdSetRef.resetFields()},FetchNetDevCmds:function(e){var t=this;this.NetDevCmdDatas=[];var a=this.page,o=a.pageNum,r=a.pageSize,n=a.pagelimit;n=o*r;var l="/netdevcmds/"+this.$route.query.device.addr+"?skip="+n+"&limit="+r;Object(s["a"])({url:l,method:"get",headers:{authorization:i.token_type+" "+i.access_token}}).then((function(e){t.page.totalRecords=e.data.count,t.NetDevCmdDatas=e.data.data}))},sizeChange:function(e){this.page.pageSize=e,this.FetchNetDevCmds()},currentChange:function(e){this.page.pageNum=e-1,this.FetchNetDevCmds()},CreateNetDevCmd:function(){var e=this;this.$refs.AddNetDevCmdRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=3;break}return e.$message.error("请输入网络设备配置命令"),t.abrupt("return",!1);case 3:Object(s["a"])({url:"/netdevicecmd",method:"post",data:e.netdevcmd,headers:{authorization:i.token_type+" "+i.access_token}}).then((function(t){200===t.data.code?(e.$message.success("增加网络设备"+t.data.data[0].addr+"的配置成功"),e.AddNetDevCmdForm=!1,e.$refs.AddNetDevCmdRef.resetFields(),e.FetchNetDevCmds(e.netdevcmd.addr)):e.$message.error("增加网络设备的配置失败,错误代码  "+t.data.message)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},DevCmdDetail:function(e){this.DetaildevCmdForm=!0,this.FetchNetDevDetail(e)},FetchNetDevDetail:function(e){var t=this;this.DevCmdData=[];var a="/netdevcmd/"+e;Object(s["a"])({url:a,method:"get",headers:{authorization:i.token_type+" "+i.access_token}}).then((function(e){t.DevCmdData=e.data}))},SetNetDevCmd:function(e){this.SetDevCmdForm=!0,this.devcmdset.id=e},NetDevCmdSet:function(){var e=this;this.$refs.DevCmdSetRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=3;break}return e.$message.error("请输入网络设备的配置命令组"),t.abrupt("return",!1);case 3:Object(s["a"])({url:"/setnetdevcmd",method:"post",data:e.devcmdset,headers:{authorization:i.token_type+" "+i.access_token}}).then((function(t){200===t.data.code?(e.$message.success("修改网络设备"+t.data.data[0].addr+"的配置成功"),e.SetDevCmdForm=!1,e.$refs.DevCmdSetRef.resetFields()):e.$message.error("修改网络设备的配置失败,错误代码  "+t.data.message)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},NetDevCmdDel:function(e){var t=this;this.$confirm("此操作将永久删除网络设备"+e.cmdmode+", 是否继续?","提示",{type:"warning"}).then((function(){Object(s["a"])({url:"/deletedevcmd/"+e.id,method:"post",headers:{authorization:i.token_type+" "+i.access_token}}).then((function(a){200===a.data.code?(t.$message.success("删除网络设备命令"+e.cmdmode+"成功"),t.FetchNetDevCmds(t.$route.query.device.addr)):t.$message.error("删除网络设备命令失败,错误 "+a.data.message)}))})).catch((function(){}))}}},c=d,u=(a("c79d"),a("2877")),m=Object(u["a"])(c,o,r,!1,null,"4a2a7967",null);t["default"]=m.exports},feb1:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/zones"}}},[e._v("资源池")]),a("el-breadcrumb-item",[e._v(e._s(e.$route.query.zone))])],1)],1),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("div",{staticClass:"handle-box"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-guide"}}),a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:""}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"}}),a("el-button",{staticClass:"mr10",attrs:{type:"primary",icon:"el-icon-plus "},on:{click:function(t){e.AddNetDevForm=!0}}})],1),a("el-dialog",{attrs:{title:"增加网络设备",visible:e.AddNetDevForm,width:"30%","close-on-click-modal":!1,center:""},on:{close:e.AddNetDevDialogClose,"update:visible":function(t){e.AddNetDevForm=t}}},[a("el-form",{ref:"AddNetDevRef",attrs:{model:e.add_netdev,rules:e.AddNetDevRules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"设备厂商",prop:"mfrs"}},[a("el-select",{staticStyle:{width:"280px"},attrs:{placeholder:"请选择生产商"},model:{value:e.add_netdev.mfrs,callback:function(t){e.$set(e.add_netdev,"mfrs",t)},expression:"add_netdev.mfrs"}},[a("el-option",{key:"h3c",attrs:{label:"H3C",value:"h3c"}}),a("el-option",{key:"hw",attrs:{label:"HUAWEI",value:"hw"}}),a("el-option",{key:"cisco",attrs:{label:"CISCO",value:"cisco"}})],1)],1),a("el-form-item",{attrs:{label:"设备地址",prop:"addr"}},[a("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"10.0.0.1","auto-complete":"off"},model:{value:e.add_netdev.addr,callback:function(t){e.$set(e.add_netdev,"addr",t)},expression:"add_netdev.addr"}})],1),a("el-form-item",{attrs:{label:"设备类型",prop:"devmode"}},[a("el-select",{staticStyle:{width:"280px"},attrs:{placeholder:"请选择网络设备类型"},model:{value:e.add_netdev.devmode,callback:function(t){e.$set(e.add_netdev,"devmode",t)},expression:"add_netdev.devmode"}},[a("el-option",{key:"rout",attrs:{label:"路由器",value:"rout"}}),a("el-option",{key:"fire",attrs:{label:"防火墙",value:"fire"}}),a("el-option",{key:"core",attrs:{label:"核心交换机",value:"core"}}),a("el-option",{key:"aces",attrs:{label:"接入交换机",value:"aces"}})],1)],1),a("el-form-item",{attrs:{label:"登录方式",prop:"authmode"}},[a("el-select",{staticStyle:{width:"280px"},attrs:{placeholder:"请选择网络设备登录方式"},model:{value:e.add_netdev.authmode,callback:function(t){e.$set(e.add_netdev,"authmode",t)},expression:"add_netdev.authmode"}},[a("el-option",{key:"pwd",attrs:{label:"密码登录",value:"pwd"}}),a("el-option",{key:"key",attrs:{label:"密钥登录",value:"key"}})],1)],1),a("el-form-item",{attrs:{label:"设备端口",prop:"devport"}},[a("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"device port","auto-complete":"off"},model:{value:e.add_netdev.devport,callback:function(t){e.$set(e.add_netdev,"devport",t)},expression:"add_netdev.devport"}})],1),a("el-form-item",{attrs:{label:"设备用户",prop:"authuser"}},[a("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"username","auto-complete":"off"},model:{value:e.add_netdev.authuser,callback:function(t){e.$set(e.add_netdev,"authuser",t)},expression:"add_netdev.authuser"}})],1),"pwd"==e.add_netdev.authmode?a("div",[a("el-form-item",{attrs:{label:"用户密码",prop:"authpwd"}},[a("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"password","auto-complete":"off"},model:{value:e.add_netdev.authpwd,callback:function(t){e.$set(e.add_netdev,"authpwd",t)},expression:"add_netdev.authpwd"}})],1)],1):"key"==e.add_netdev.authmode?a("div",[a("el-form-item",{attrs:{label:"用户私钥",prop:"authkey"}},[a("el-input",{staticStyle:{width:"280px"},attrs:{type:"textarea",placeholder:"private key text content",rows:5,"auto-complete":"off"},model:{value:e.add_netdev.authkey,callback:function(t){e.$set(e.add_netdev,"authkey",t)},expression:"add_netdev.authkey"}})],1)],1):e._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.CreateNetDev}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.AddNetDevForm=!1}}},[e._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:"网络设备登录信息设置",visible:e.SetNetDevInfoForm,width:"40%","close-on-click-modal":!1,center:""},on:{close:e.SetNetDevInfoDialogClose,"update:visible":function(t){e.SetNetDevInfoForm=t}}},[a("el-form",{ref:"SetNetDevInfoRef",attrs:{model:e.setnetdevinfo,rules:e.SetNetDevInfoRules,"label-width":"140px","label-position":"left"}},[a("el-form-item",{attrs:{label:"登录方式",prop:"authmode"}},[a("el-select",{staticStyle:{width:"350px"},attrs:{placeholder:"请选择网络设备登录方式"},model:{value:e.setnetdevinfo.authmode,callback:function(t){e.$set(e.setnetdevinfo,"authmode",t)},expression:"setnetdevinfo.authmode"}},[a("el-option",{key:"pwd",attrs:{label:"密码登录",value:"pwd"}}),a("el-option",{key:"key",attrs:{label:"密钥登录",value:"key"}})],1)],1),a("el-form-item",{attrs:{label:"设备用户",prop:"authuser"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"username","auto-complete":"off"},model:{value:e.setnetdevinfo.authuser,callback:function(t){e.$set(e.setnetdevinfo,"authuser",t)},expression:"setnetdevinfo.authuser"}})],1),"pwd"==e.setnetdevinfo.authmode?a("div",[a("el-form-item",{attrs:{label:"用户密码",prop:"authpwd"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"password","auto-complete":"off"},model:{value:e.setnetdevinfo.authpwd,callback:function(t){e.$set(e.setnetdevinfo,"authpwd",t)},expression:"setnetdevinfo.authpwd"}})],1)],1):"key"==e.setnetdevinfo.authmode?a("div",[a("el-form-item",{attrs:{label:"用户私钥",prop:"authkey"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{type:"textarea",placeholder:"private key text content",rows:5,"auto-complete":"off"},model:{value:e.setnetdevinfo.authkey,callback:function(t){e.$set(e.setnetdevinfo,"authkey",t)},expression:"setnetdevinfo.authkey"}})],1)],1):e._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.NetDevInfoSet}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.SetNetDevInfoForm=!1}}},[e._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:"宿主节点详细资料",visible:e.DetailNetdevForm,width:"40%",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.DetailNetdevForm=t}}},[a("div",{attrs:{"text-align:center":""}},[a("b-table-simple",{attrs:{hover:"",small:"","caption-top":"",responsive:""}},[a("b-tbody",[a("b-tr",[a("b-td",{attrs:{colspan:"2"}},[e._v("资源区域")]),a("b-td",{attrs:{colspan:"1"}},[e._v(e._s(e.NetDevData.zone))])],1),a("b-tr",[a("b-td",{attrs:{colspan:"2"}},[e._v("网络设备名称")]),a("b-td",{attrs:{colspan:"1"}},[e._v(e._s(e.NetDevData.device))])],1),a("b-tr",[a("b-td",{attrs:{colspan:"2"}},[e._v("网络设备地址")]),a("b-td",{attrs:{colspan:"1"}},[e._v(e._s(e.NetDevData.addr))])],1),a("b-tr",[a("b-td",{attrs:{colspan:"2"}},[e._v("设备使用状态")]),a("b-td",{attrs:{colspan:"1"}},["open"==e.NetDevData.state?a("span",[e._v("启用")]):a("span",[e._v("锁定")])])],1),a("b-tr",[a("b-td",{attrs:{colspan:"2"}},[e._v("网络设备用户")]),a("b-td",{attrs:{colspan:"1"}},[e._v(e._s(e.NetDevData.authuser))])],1),a("b-tr",[a("b-td",{attrs:{colspan:"2"}},[e._v("网络设备密码")]),a("b-td",{attrs:{colspan:"1"}},[e._v(e._s(e.NetDevData.authpwd))])],1),a("b-tr",[a("b-td",{attrs:{colspan:"2"}},[e._v("网络设备密钥")]),a("b-td",{attrs:{colspan:"1"}},[e._v(e._s(e.NetDevData.authfile))])],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.DetailNetdevForm=!1}}},[e._v("确 定")])],1)])],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.NetDevDatas,"header-cell-class-name":"table-header"}},[e.show?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}):e._e(),a("el-table-column",{attrs:{prop:"device",label:"网络设备名称",align:"center"}}),a("el-table-column",{attrs:{prop:"addr",label:"网络设备地址",align:"center"}}),a("el-table-column",{attrs:{prop:"devmode",label:"网络设备类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["rout"===t.row.devmode?a("span",{staticStyle:{color:"#0000CD"}},[e._v("路由器")]):"fire"===t.row.devmode?a("span",{staticStyle:{color:"#DC143C"}},[e._v("防火墙")]):"core"===t.row.devmode?a("span",{staticStyle:{color:"#708090"}},[e._v("核心交换机")]):"aces"===t.row.devmode?a("span",{staticStyle:{color:"#40E0D0"}},[e._v("接入交换机")]):a("span",{staticStyle:{color:"red"}},[e._v("错误设备")])]}}])}),a("el-table-column",{attrs:{prop:"state",label:"使用状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return["open"===e.row.state?a("span",{staticStyle:{color:"#37B328"}},[a("b-icon",{attrs:{icon:"unlock"}})],1):a("span",{staticStyle:{color:"red"}},[a("i",{staticClass:"el-icon-lock"})])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"运行状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["up"===t.row.status?a("span",{staticStyle:{color:"#37B328"}},[e._v("在线")]):a("span",{staticStyle:{color:"red"}},[e._v("离线")])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return["open"===t.row.state?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"锁定网络设备",placement:"top-start"}},[a("el-button",{staticStyle:{color:"red"},attrs:{icon:"el-icon-lock",circle:""},on:{click:function(a){return e.Disable(t.row)}}})],1):a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"解锁网络设备",placement:"top-start"}},[a("el-button",{staticStyle:{color:"#37B328"},attrs:{circle:""},on:{click:function(a){return e.Enable(t.row)}}},[a("b-icon",{attrs:{icon:"unlock"}})],1)],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"网络设备登录信息设置",placement:"top-start"}},[a("el-button",{attrs:{type:"orange",circle:""},on:{click:function(a){return e.SetDevPwd(t.row.id,t.row.addr)}}},[a("b-icon",{attrs:{icon:"wrench"}})],1)],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"网络设备详情",placement:"top-start"}},[a("el-button",{attrs:{type:"orange",icon:"el-icon-menu",circle:""},on:{click:function(a){return e.NetDevDetail(t.row.id)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设备配置命令",placement:"top-start"}},[a("el-button",{attrs:{type:"orange",circle:""},on:{click:function(a){return e.NetDevCmd(t.row.addr,e.$route.query.zone)}}},[a("b-icon",{attrs:{icon:"hammer"}})],1)],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除网络设备",placement:"top-start"}},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.NetDevDel(t.row)}}})],1)]}}])})],1),a("div",{staticClass:"block",staticStyle:{height:"70px"}},[a("el-pagination",{attrs:{"page-sizes":[10,20],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next",total:e.page.totalRecords},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)],1)},r=[],n=(a("96cf"),a("1da1")),s=a("0c6d"),l=sessionStorage.getItem("user_info"),i=JSON.parse(l),d={data:function(){return{show:!1,netaddr:"",NetDevDatas:[],NetDevData:[],AddNetDevForm:!1,SetNetDevInfoForm:!1,DetailNetdevForm:!1,add_netdev:{mfrs:"h3c",addr:"",authmode:"pwd",devmode:"",devport:22,authuser:"",authpwd:"",authkey:"",zone:this.$route.query.zone},setnetdevinfo:{id:"",addr:"",authmode:"",authuser:"",authpwd:"",authkey:""},AddNetDevRules:{mfrs:[{required:!0,message:"请选择网络制造商",trigger:"blur"}],addr:[{required:!0,message:"请输入网络设备IP地址",trigger:"blur"}],devmode:[{required:!0,message:"请选择网络设备类型",trigger:"blur"}],devport:[{required:!0,message:"请输入网络设备端口",trigger:"blur"}],authmode:[{required:!0,message:"请选择网络设备登录方式",trigger:"blur"}],authuser:[{required:!0,message:"请输入网络设备用户",trigger:"blur"}]},SetNetDevInfoRules:{authuser:[{required:!0,message:"请输入网络设备用户",trigger:"blur"}],authmode:[{required:!0,message:"请输入选择网络设备登录方式",trigger:"blur"}]},page:{pageSize:10,totalRecords:0,totalPages:0,pageNum:0,pagelimit:0}}},mounted:function(){this.FetchNetDevices()},methods:{AddNetDevDialogClose:function(){void 0!==this.$refs.AddNetDevRef&&this.$refs.AddNetDevRef.resetFields()},SetNetDevInfoDialogClose:function(){void 0!==this.$refs.SetNetDevInfoRef&&this.$refs.SetNetDevInfoRef.resetFields()},FetchNetDevices:function(){var e=this;this.NetDevDatas=[];var t=this.page,a=t.pageNum,o=t.pageSize,r=t.pagelimit;r=a*o;var n="/netdevs/"+this.$route.query.zone+"?skip="+r+"&limit="+o;Object(s["a"])({url:n,method:"get",headers:{authorization:i.token_type+" "+i.access_token}}).then((function(t){e.page.totalRecords=t.data.count,e.NetDevDatas=t.data.data}))},sizeChange:function(e){this.page.pageSize=e,this.FetchNetDevices()},currentChange:function(e){this.page.pageNum=e-1,this.FetchNetDevices()},CreateNetDev:function(){var e=this;this.$refs.AddNetDevRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=3;break}return e.$message.error("请输入网络设备IP地址"),t.abrupt("return",!1);case 3:Object(s["a"])({url:"/netdev",method:"post",data:e.add_netdev,headers:{authorization:i.token_type+" "+i.access_token}}).then((function(t){200===t.data.code?(e.$message.success("增加网络设备"+t.data.data[0].addr+"成功"),e.AddNetDevForm=!1,e.$refs.AddNetDevRef.resetFields(),e.FetchNetDevices()):e.$message.error("增加网络设备失败,错误代码  "+t.data.message)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},Disable:function(e){var t=this;if("open"===e.state){var a={id:e.id,state:"lock"};this.$confirm("确认禁用网络设备"+e.addr+", 是否继续?","提示",{type:"warning"}).then((function(){Object(s["a"])({url:"/setnetdevstate",method:"post",data:a,headers:{authorization:i.token_type+" "+i.access_token}}).then((function(a){200===a.data.code?(t.$message.success("网络设备"+a.data.data[0].addr+"禁用成功"),t.FetchNetDevices()):t.$message.error("禁用网络设备"+e.addr+"失败,原因  "+a.data.message)}))})).catch((function(){}))}},Enable:function(e){var t=this;if("lock"===e.state){var a={id:e.id,state:"open"};this.$confirm("确认启用网络设备"+e.addr+", 是否继续?","提示",{type:"warning"}).then((function(){Object(s["a"])({url:"/setnetdevstate",method:"post",data:a,headers:{authorization:i.token_type+" "+i.access_token}}).then((function(a){200===a.data.code?(t.$message.success("网络设备"+a.data.data[0].addr+"启用成功"),t.FetchNetDevices()):t.$message.error("启用网络设备"+e.addr+"失败,原因  "+a.data.message)}))})).catch((function(){}))}},NetDevDetail:function(e){this.DetailNetdevForm=!0,this.FetchNetDevDetail(e)},FetchNetDevDetail:function(e){var t=this;this.NetDevData=[];var a="/netdev/"+e;Object(s["a"])({url:a,method:"get",headers:{authorization:i.token_type+" "+i.access_token}}).then((function(e){t.NetDevData=e.data}))},NetDevCmd:function(e,t){var a={addr:e,zone:t};this.$router.push({path:"/netdevcmds",query:{device:a}})},SetDevPwd:function(e,t){this.SetNetDevInfoForm=!0,this.setnetdevinfo.id=e,this.setnetdevinfo.addr=t},NetDevInfoSet:function(){var e=this;this.$refs.SetNetDevInfoRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=3;break}return e.$message.error("请输入网络设备登录信息"),t.abrupt("return",!1);case 3:Object(s["a"])({url:"/setnetdevpwd",method:"post",data:e.setnetdevinfo,headers:{authorization:i.token_type+" "+i.access_token}}).then((function(t){200===t.data.code?(e.$message.success("设置网络设备"+t.data.data[0].addr+"的登录信息成功"),e.SetNetDevInfoForm=!1,e.$refs.SetNetDevInfoRef.resetFields()):e.$message.error("设置网络设备的登录信息失败,错误代码  "+t.data.message)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},NetDevDel:function(e){var t=this;this.$confirm("此操作将永久删除网络设备"+e.addr+", 是否继续?","提示",{type:"warning"}).then((function(){Object(s["a"])({url:"/deletenetdev/"+e.id,method:"post",headers:{authorization:i.token_type+" "+i.access_token}}).then((function(e){200===e.data.code?(t.$message.success("删除网络设备"+e.data.data[0].addr+"成功"),t.FetchNetDevices()):t.$message.error("删除网络设备失败,  "+e.data.message)}))})).catch((function(){}))}}},c=d,u=(a("9b2c"),a("2877")),m=Object(u["a"])(c,o,r,!1,null,"e54c17aa",null);t["default"]=m.exports}}]);