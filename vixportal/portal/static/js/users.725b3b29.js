(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["users"],{"0c6d":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return i}));var r=a("bc3a"),s=a.n(r);function n(e){var t=s.a.create({baseURL:window.url.ssourl,timeout:5e3});return t(e)}function o(e){var t=s.a.create({baseURL:window.url.coreurl,timeout:5e3});return t(e)}function i(e){var t=s.a.create({baseURL:window.url.vneturl,timeout:5e3});return t(e)}},"1b1b":function(e,t,a){},"1da1":function(e,t,a){"use strict";function r(e,t,a,r,s,n,o){try{var i=e[n](o),l=i.value}catch(d){return void a(d)}i.done?t(l):Promise.resolve(l).then(r,s)}function s(e){return function(){var t=this,a=arguments;return new Promise((function(s,n){var o=e.apply(t,a);function i(e){r(o,s,n,i,l,"next",e)}function l(e){r(o,s,n,i,l,"throw",e)}i(void 0)}))}}a.d(t,"a",(function(){return s}))},"2de2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("el-tabs",[a("el-tab-pane",[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-s-custom"}),e._v(" 用户管理")]),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"用户名"},model:{value:e.user,callback:function(t){e.user=t},expression:"user"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.AddUserForm=!0}}}),a("el-dialog",{attrs:{title:"增加用户",visible:e.AddUserForm,width:"30%",center:""},on:{close:e.AddDialogClose,"update:visible":function(t){e.AddUserForm=t}}},[a("el-form",{ref:"AddUserRef",attrs:{model:e.add_user,rules:e.AddUserRules,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"用户名称",prop:"username"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"username","auto-complete":"off"},model:{value:e.add_user.username,callback:function(t){e.$set(e.add_user,"username",t)},expression:"add_user.username"}})],1),a("el-form-item",{attrs:{label:"用户密码",prop:"password"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{type:"password",placeholder:"password","auto-complete":"off"},model:{value:e.add_user.password,callback:function(t){e.$set(e.add_user,"password",t)},expression:"add_user.password"}})],1),a("el-form-item",{attrs:{label:"用户权限",prop:"priv"}},[a("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"请选择权限"},on:{focus:e.getpriv},model:{value:e.add_user.priv,callback:function(t){e.$set(e.add_user,"priv",t)},expression:"add_user.priv"}},[a("el-option",{key:"1",attrs:{label:"administrator",value:"1"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.CreateUser}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.AddUserForm=!1}}},[e._v("取 消")])],1)],1)],1),a("el-dialog",{attrs:{title:"修改密码",visible:e.EditPwdForm,width:"30%",center:""},on:{close:e.AddDialogClose,"update:visible":function(t){e.EditPwdForm=t}}},[a("el-form",{ref:"EditPwdRef",attrs:{model:e.EditPwd,rules:e.EditPwdRules,"label-width":"100px","label-position":"left"}},[a("el-input",{staticStyle:{display:"none"},attrs:{placeholder:"username","auto-complete":"off",readonlys:""},model:{value:e.EditPwd.username,callback:function(t){e.$set(e.EditPwd,"username",t)},expression:"EditPwd.username"}}),a("el-form-item",{attrs:{label:"用户密码",prop:"password"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{type:"password",placeholder:"password","auto-complete":"off"},model:{value:e.EditPwd.password,callback:function(t){e.$set(e.EditPwd,"password",t)},expression:"EditPwd.password"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.PwdEditFrom}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.EditPwdForm=!1}}},[e._v("取 消")])],1)],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.userData,"header-cell-class-name":"table-header"}},[e.show?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"100",align:"center"}}):e._e(),a("el-table-column",{attrs:{prop:"username",label:"用户名称",align:"center"}}),a("el-table-column",{attrs:{prop:"priv",label:"用户权限",align:"center"}}),a("el-table-column",{attrs:{prop:"create_time",label:"创建时间",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改密码",placement:"top-start"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-edit"},on:{click:function(a){return e.PwdEdit(t.$index,t.row)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除用户",placement:"top-start"}},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(a){return e.UserDelete(t.row)}}})],1)]}}])})],1),a("div",{staticClass:"block",staticStyle:{height:"70px"}},[a("el-pagination",{attrs:{"page-sizes":[10,20],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next",total:e.page.totalRecords},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)],1),a("el-tab-pane",[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-wallet"}),e._v(" 权限管理")]),e._v("\n      权限管理\n    ")])],1)],1)},s=[],n=(a("96cf"),a("1da1")),o=a("0c6d"),i=sessionStorage.getItem("user_info"),l=JSON.parse(i),d={data:function(){return{show:!1,user:"",PrivData:[],userData:[],AddUserForm:!1,EditPwdForm:!1,page:{pageSize:10,totalRecords:0,totalPages:0,pageNum:0,pagelimit:0},add_user:{username:"",password:"",priv:""},EditPwd:{username:"",password:""},AddUserRules:{username:[{required:!0,message:"请输入用户名称",trigger:"blur"}],password:[{required:!0,message:"请输入用户密码",trigger:"blur"}],priv:[{required:!0,message:"请选择用户权限",trigger:"blur"}]},EditPwdRules:{password:[{required:!0,message:"请输入用户密码",trigger:"blur"}]},formLabelWidth:"120px"}},mounted:function(){this.getUsers()},methods:{AddDialogClose:function(){void 0!==this.$refs.AddFormRef&&this.$refs.AddFormRef.resetFields()},getpriv:function(){var e=this;this.PrivData=[];var t=this.page,a=t.pageNum,r=t.pageSize,s=t.pagelimit;s=a*r,Object(o["c"])({url:"/privs?skip="+s+"&limit="+r,method:"get",headers:{authorization:l.token_type+" "+l.access_token}}).then((function(t){e.PrivData=t.data}))},getUsers:function(){var e=this;this.userData=[];var t=this.page,a=t.pageNum,r=t.pageSize,s=t.pagelimit;s=a*r,Object(o["c"])({url:"/users?skip="+s+"&limit="+r,method:"get",headers:{authorization:l.token_type+" "+l.access_token}}).then((function(t){e.page.totalRecords=t.data.count,e.userData=t.data.data}))},sizeChange:function(e){this.page.pageSize=e,this.getUsers()},currentChange:function(e){this.page.pageNum=e-1,this.getUsers()},CreateUser:function(){var e=this;console.log(this.add_user),this.$refs.AddUserRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=3;break}return e.$message.error("请输入用户名称和用户密码"),t.abrupt("return",!1);case 3:Object(o["c"])({url:"/users",method:"post",data:e.add_user,headers:{authorization:l.token_type+" "+l.access_token}}).then((function(t){200===t.data.code?(e.$message.success("增加新用户"+t.data.data.username+"成功"),e.AddUserForm=!1,e.$refs.AddUserRef.resetFields(),e.getUsers()):e.$message.error("新增用户失败，用户已存在或者其它错误")}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},PwdEdit:function(e,t){this.EditPwdForm=!0,this.EditPwd=Object.assign({},t)},PwdEditFrom:function(){var e=this;this.$refs.EditPwdRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=3;break}return e.$message.error("请输入用户密码"),t.abrupt("return",!1);case 3:Object(o["c"])({url:"/setpwd",method:"post",data:e.EditPwd,headers:{authorization:l.token_type+" "+l.access_token}}).then((function(t){200===t.data.code?(e.$message.success("修改用户"+t.data.data.username+"的密码成功"),e.EditPwdForm=!1):e.$message.error("修改用户密码失败，存在错误")}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},UserDelete:function(e){var t=this;this.$confirm("是否永久删除用户 "+e.username+", 是否继续?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then((function(){Object(o["c"])({url:"/removeuser/"+e.id,method:"post",headers:{authorization:l.token_type+" "+l.access_token}}).then((function(a){200===a.data.code?(t.$message.success("删除用户成功"+e.username+"成功"),t.getUsers()):t.$message.error("删除云主机"+e.username+"失败")}))})).catch((function(){}))}}},c=d,u=(a("af2f"),a("2877")),p=Object(u["a"])(c,r,s,!1,null,"6837bf32",null);t["default"]=p.exports},af2f:function(e,t,a){"use strict";a("1b1b")}}]);